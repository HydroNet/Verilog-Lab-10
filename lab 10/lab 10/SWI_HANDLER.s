	GLOBAL SWI_HANDLER
	IMPORT user_code
			AREA SWIHANDLER, CODE, READONLY
				
SWI_HANDLER		
PINSEL0	EQU 0XE002C000
IO0PIN	EQU 0XE0028000
IO0SET	EQU 0X4
IO0DIR	EQU 0X8
IO0CLR	EQU 0XC
LEDMASK EQU 0xFF00
CLOCK	EQU		12000000
DELAY1S		EQU		(CLOCK/4)
		STMFD SP!, {R0-R6, LR}
		SUB R0, LR, #4
		LDR R1, [R0]
		BIC R1, #0XFF000000
		TEQ R1, #1
		BLEQ LED_LIGHT	
		LDR		r0, =DELAY1S
LOOP3	SUBS	r0, r0, #1
		BNE		LOOP3
		TEQ R1, #2
		BLEQ user_code
		LDR		r0, =DELAY1S
LOOP4	SUBS	r0, r0, #1
		BNE		LOOP4
		TEQ R1, #3
		BLEQ LED_OFF
		LDMFD SP!, {R0-R6, PC}^
		
		
LED_LIGHT
		STMFD SP!, {R0-R6, LR}
		MRS R0, CPSR
		STMFD SP!, {R0}
		LDR R3, =IO0PIN
		MOV	R2, #LEDMASK ;turn LED's on
		STR R2,[R3,#IO0CLR]
		LDMFD SP!, {R0}
		MSR CPSR_f, R0
		LDMFD SP!, {R0-R6,PC}
LED_OFF
		STMFD SP!, {R0-R6, LR}
		MRS R0, CPSR
		STMFD SP!, {R0}
		LDR R3, =IO0PIN
		MOV R2, #LEDMASK
		STR R2,[R3,#IO0SET];TURN ALL OFF
		;LDMFD SP!, {R0}
		;MSR CPSR_f, R0
		LDMFD SP!, {R0-R6,PC}^
		END
			
		